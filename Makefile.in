all:
	$(MAKE) omc @OMLIBRARY_TARGET@ testsuite-depends
	$(MAKE) omedit omnotebook omoptim

.PRECIOUS: Makefile
.PHONY: omc omlibrary-all omlibrary-core omplot omedit omoptim testsuite-depends

omc:
	$(MAKE) -C OMCompiler @OMC_TARGET@
omlibrary-core:
	$(MAKE) -C libraries BUILD_DIR=@OMBUILDDIR@/lib/omlibrary core
omlibrary-all:
	$(MAKE) -C libraries BUILD_DIR=@OMBUILDDIR@/lib/omlibrary all
omplot:
	$(MAKE) -C OMPlot
omedit: omplot
	$(MAKE) -C OMEdit
omoptim: omplot
	$(MAKE) -C OMOptim
omnotebook: omplot
	$(MAKE) -C OMNotebook
testsuite-depends:
	$(MAKE) --quiet -C testsuite "OMBUILDDIR=@OMBUILDDIR@" CC="@CC@" CFLAGS="@CFLAGS@" omc-diff ReferenceFiles

clean:
	test ! -d build || rm -r build/

Makefile: Makefile.in config.status
	./config.status
config.status: configure
	./config.status -recheck
configure: configure.ac
	autoconf
