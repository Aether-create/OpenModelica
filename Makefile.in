all:
	$(MAKE) omc @OMLIBRARY_TARGET@ testsuite-depends
	$(MAKE) omplot
	$(MAKE) omedit omoptim

.PRECIOUS: Makefile
.PHONY: omc omlibrary-all omlibrary-core omplot omedit omoptim testsuite-depends

omc:
	$(MAKE) -C OMCompiler @OMC_TARGET@
omlibrary-core:
	$(MAKE) -C libraries BUILD_DIR=@OMBUILDDIR@/lib/omlibrary core
omlibrary-all:
	$(MAKE) -C libraries BUILD_DIR=@OMBUILDDIR@/lib/omlibrary all
omplot:
	$(MAKE) -C OMPlot
omedit:
	$(MAKE) -C OMEdit
omoptim:
	$(MAKE) -C OMOptim
testsuite-depends:
	$(MAKE) --quiet -C testsuite "OMBUILDDIR=@OMBUILDDIR@" CC="@CC@" CFLAGS="@CFLAGS@" omc-diff ReferenceFiles

clean:
	test ! -d build || rm -r build/

Makefile: Makefile.in config.status
	./config.status
config.status: configure
	./config.status -recheck
configure: configure.ac
	autoconf
